#!/bin/bash

[[ "${DEBUG}" =~ ^(true|on|1)$ ]] && set -x

set -e

# Configure database for pimcore
mysql -u${DB_ROOT_USER} -p${DB_ROOT_PASSWORD} -h${MAGENTO_APP_DB_HOST} -e "DROP DATABASE IF EXISTS ${MAGENTO_APP_DB_NAME}; \
	CREATE DATABASE ${MAGENTO_APP_DB_NAME} charset=utf8; \
	CREATE USER IF NOT EXISTS '${MAGENTO_APP_DB_USER}'@'%' IDENTIFIED BY '${MAGENTO_APP_DB_PASSWORD}'; \
	GRANT ALL ON ${MAGENTO_APP_DB_NAME}.* TO '${MAGENTO_APP_DB_USER}'@'%' WITH GRANT OPTION; \
	FLUSH PRIVILEGES;"
